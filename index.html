<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Shop Stock Manager</title>

<style>
    body {
        font-family: Arial, sans-serif;
        margin: 0;
        background: #f5f6fa;
    }

    header {
        display: flex;
        justify-content: space-between;
        padding: 15px 20px;
        background: white;
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        position: sticky;
        top: 0;
        z-index: 10;
    }

    h2 {
        margin: 0;
    }

    button {
        padding: 10px 18px;
        border: none;
        background: black;
        color: white;
        border-radius: 8px;
        cursor: pointer;
    }

    .card {
        margin: 20px;
        padding: 20px;
        background: white;
        border-radius: 12px;
        box-shadow: 0 1px 4px rgba(0,0,0,0.1);
    }

    input, select {
        width: 100%;
        padding: 10px;
        margin: 6px 0;
        border-radius: 8px;
        border: 1px solid #ccc;
    }

    table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 10px;
    }

    th, td {
        padding: 10px;
        text-align: left;
        border-bottom: 1px solid #eee;
    }

    .delete-btn {
        width: 24px;
        cursor: pointer;
    }

    /* MOBILE RESPONSIVE TABLE */
    @media (max-width: 700px) {
        table, thead, tbody, th, td, tr {
            display: block;
        }
        thead { display: none; }
        tr {
            margin-bottom: 15px;
            background: #fff;
            padding: 10px;
            border-radius: 10px;
        }
        td {
            display: flex;
            justify-content: space-between;
            padding: 8px 5px;
        }
        td::before {
            content: attr(data-label);
            font-weight: bold;
        }
    }
</style>
</head>
<body>

<header>
    <h2>Gangani Auto Electricals</h2>
    <button onclick="openForm()">Add Item</button>
</header>

<div class="card">
    <h3>Search Stock</h3>
    <input id="search" type="text" placeholder="Search part name or number..." onkeyup="filterTable()">
</div>

<div class="card">
    <table id="stockTable">
        <thead>
            <tr>
                <th>Part Name</th>
                <th>Vehicle</th>
                <th>Part No</th>
                <th>Stock</th>
                <th>Buy Price</th>
                <th>Sell Price</th>
                <th>Delete</th>
            </tr>
        </thead>
        <tbody id="tableBody"></tbody>
    </table>
</div>

<!-- POPUP FORM -->
<div id="popup" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%;
background:rgba(0,0,0,0.5); display:flex; align-items:center; justify-content:center;">
    <div class="card" style="width:90%; max-width:400px;">
        <h3>Add New Item</h3>

        <input id="pname" placeholder="Part Name">
        <input id="vehicle" placeholder="Vehicle">
        <input id="pno" placeholder="Part Number">
        <input id="stock" placeholder="Stock" type="number">
        <input id="buy" placeholder="Buy Price" type="number">
        <input id="sell" placeholder="Sell Price" type="number">

        <button onclick="addItem()" style="width:100%; margin-top:10px;">Save Item</button>
        <button onclick="closeForm()" style="width:100%; margin-top:10px; background:#aaa;">Cancel</button>
    </div>
</div>

<!-- FIREBASE CDN -->
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js"></script>

<script>
    // Your Firebase Config
    const firebaseConfig = {
        apiKey: "AIzaSyBN9LWPP0tebZiCtXMAKatKivb5lX0g1_g",
        authDomain: "shopstock-d304a.firebaseapp.com",
        databaseURL: "https://shopstock-d304a-default-rtdb.asia-southeast1.firebasedatabase.app",
        projectId: "shopstock-d304a",
        storageBucket: "shopstock-d304a.firebasestorage.app",
        messagingSenderId: "82450149368",
        appId: "1:82450149368:web:3772ec3a4d96d8c1ecf00d",
        measurementId: "G-0VWDCPSVSX"
    };

    const app = firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    // SHOW POPUP
    function openForm() { document.getElementById("popup").style.display = "flex"; }
    function closeForm() { document.getElementById("popup").style.display = "none"; }

    // ADD ITEM
    function addItem() {
        let item = {
            pname: pname.value,
            vehicle: vehicle.value,
            pno: pno.value,
            stock: stock.value,
            buy: buy.value,
            sell: sell.value
        };

        db.ref("items/" + item.pno).set(item);

        closeForm();
        loadData();
    }

    // LOAD DATA
    function loadData() {
        db.ref("items").on("value", snapshot => {
            let table = "";
            snapshot.forEach(child => {
                let d = child.val();
                table += `
                <tr>
                    <td data-label="Part Name">${d.pname}</td>
                    <td data-label="Vehicle">${d.vehicle}</td>
                    <td data-label="Part No">${d.pno}</td>
                    <td data-label="Stock">${d.stock}</td>
                    <td data-label="Buy Price">${d.buy}</td>
                    <td data-label="Sell Price">${d.sell}</td>
                    <td data-label="Delete">
                        <img class="delete-btn" onclick="deleteItem('${d.pno}')" 
                        src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%23dc3545'%3E%3Cpath d='M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-9l-1 1H5v2h14V4z'/%3E%3C/svg%3E">
                    </td>
                </tr>`;
            });
            document.getElementById("tableBody").innerHTML = table;
        });
    }

    loadData();

    // DELETE
    function deleteItem(pno) {
        db.ref("items/" + pno).remove();
    }

    // SEARCH FILTER
    function filterTable() {
        let q = document.getElementById("search").value.toLowerCase();
        let rows = document.querySelectorAll("#tableBody tr");

        rows.forEach(row => {
            row.style.display = row.innerText.toLowerCase().includes(q) ? "" : "none";
        });
    }
</script>

</body>
</html>
